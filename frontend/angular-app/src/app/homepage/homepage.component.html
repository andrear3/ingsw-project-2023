<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Homepage</title>
  </head>
  <body>
    <nav>
      <app-navbar></app-navbar>
    </nav>
    <main>
      <!-- Search input for filtering -->
      <div class="search-bar">
        <input
          type="text"
          placeholder="Search auctions..."
          (input)="filterResults($event)"
        />
      </div>

      <div class="card-container">
        <!-- Using @for directive for asteFiltrate and handling null values -->
        @for (asta of asteFiltrate; track asta) {
          <mat-card 
            (click)="navigateToviewAsta(asta)" 
            class="card"
            *ngIf="asta">
            <div class="card-item">
              <div class="card-image">
                <img
                  [src]="asta?.url || 'placeholder.jpg'"
                  alt="Immagine di {{ asta?.nomeBeneInVendita || 'N/A' }}"
                />
              </div>
              <div class="card-content">
                <h2 class="card-title">{{ asta?.titolo || 'Titolo non disponibile' }}</h2>
                <h3 class="card-subtitle">{{ asta?.nomeBeneInVendita || 'Nome non disponibile' }}</h3>
                <div class="card-info">
                  <p><strong>Categoria:</strong> {{ asta?.categoria || 'N/A' }}</p>
                  <p><strong>Tipo:</strong> {{ asta?.tipoBeneInVendita || 'N/A' }}</p>
                  <p>
                    <strong>Data di Fine Asta:</strong>
                    {{ asta?.dataFineAsta ? (asta.dataFineAsta | date) : 'N/A' }}
                  </p>
                  <p><strong>Creata da:</strong> {{ asta?.UtenteNickname || 'N/A' }}</p>
                  <p class="danger">
                    <strong>Offerta corrente: {{ asta?.offertaMax || 0 }}â‚¬</strong>
                  </p>
                  <p class="danger">
                    <strong>Tempo restante: {{ getFormattedTime(asta) || 'N/A' }}</strong>
                  </p>
                </div>
              </div>
            </div>
          </mat-card>
        }
      </div>
    </main>
  </body>
</html>
